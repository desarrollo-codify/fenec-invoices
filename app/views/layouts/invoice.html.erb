<!DOCTYPE html>
<html>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <head>
      <title>PDFs - Ruby on Rails</title>
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
      <%= wicked_pdf_stylesheet_link_tag "invoice" %>
  </head>
  <body> 
    <div class="container mx-0 px-0">
      <div class="w-100 text-center">
        <%= image_tag @company.logo, style: 'max-height:100px;width:auto;' %>
        <%= @company.logo %>
        <h5 class="m-0 pt-2 pb-0"><strong><%= @company.name %></strong></h5>
        <h4 class="m-0 py-0"><strong><%= @branch_office.name.upcase %></strong></h4>
        <h5 class="m-0 py-0"><%= @branch_office.address.upcase %></h5>
        <h5 class="m-0 py-0"><%= @branch_office.phone.upcase %></h5>
        <h5 class="m-0 py-0"><%= @branch_office.city.upcase %> - BOLIVIA</h5>
      </div>
      <div class="pt-4">
        <table class="table table-sm table-borderless">
          <tbody>
            <tr style="line-height:13px;height:13px;">
              <td class="w-25">SUCURSAL:</td>
              <td><%= @branch_office.name %></td>
            </tr>
            <tr style="line-height:13px;height:13px;">
              <td class="w-25">LUGAR:</td>
              <td><%= @branch_office.city %></td>
            </tr>
            <tr style="line-height:13px;height:13px;">
              <td>DIRECCION:</td>
              <td><%= @branch_office.address %></td>
            </tr>
            <tr style="line-height:13px;height:13px;">
              <td>TELEFONO:</td>
              <td><%= @branch_office.phone %></td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="w-100 text-center" style="border-bottom: 1px solid #000;">
        <h4 class="m-0 pt-0">FACTURA</h4>
        <h5 class="m-0 py-0">(Con derecho a crédito fiscal)</h5>
      </div>
      <table class="table table-sm table-borderless my-0 py-0" style="border-bottom: 1px solid #000;">
        <tbody>
          <tr style="line-height:13px;height:13px;">
            <td style="width:32%">NIT:</td>
            <td><%= @invoice.company_nit %></td>
          </tr>
          <tr style="line-height:13px;height:13px;">
            <td>Nro. FACTURA:</td>
            <td><%= @invoice.number %></td>
          </tr>
          <tr style="line-height:18px;height:18px;">
            <td>CUF:</td>
            <td class="text-break"><%= @invoice.cuf %></td>
          </tr>
        </tbody>
      </table>
      <table class="table table-sm table-borderless my-0 py-0" style="border-style: none none double;">
        <tbody>
          <tr style="line-height:13px;height:13px;">
            <td style="width:30%"><strong>Fecha:</strong></td>
            <td><strong><%= @invoice.date.strftime("%d/%m/%Y %H:%M") %></strong></td>
          </tr>
          <tr style="line-height:13px;height:13px;">
            <td><strong>NIT:</strong></td>
            <td><strong><%= @invoice.business_nit %></strong></td>
          </tr>
          <tr style="line-height:13px;height:13px;">
            <td><strong>Nombre:</strong></td>
            <td class="text-break"><strong><%= @invoice.business_name %></strong></td>
          </tr>
          <tr style="line-height:13px;height:13px;">
            <td><strong>Cod. Cliente:</strong></td>
            <td><strong><%= @invoice.client_code %></strong></td>
          </tr>
        </tbody>
      </table>
      <table class="table table-sm table-borderless my-0 py-0" style="border-bottom: 1px solid #000;">
        <thead style="line-height:13px;height:13px;">
          <th>Referencia</th>
          <th>Cantidad</th>
          <th>Precio</th>
          <th>IMPORTE</th>
        </thead>
        <tbody>
          <% @invoice.invoice_details.each do |detail| %>
            <tr style="line-height:13px;height:13px;">
              <td colspan="4"><%= detail.product_code %> <%= detail.description %></td>
            </tr>
            <tr style="line-height:13px;height:13px;">
              <td style="width:15%" class="text-right"><%= detail.quantity.to_i %></td>
              <td>PZA</td> 
              <%# <%= detail.measurement.description %>
              <td class="text-right"><%= '%.2f' % detail.unit_price %></td>
              <td class="text-right"><%= '%.2f' % detail.subtotal %></td>
            </tr>
          <% end %>
          <%# Discount ??? %>
        </tbody>
      </table>
      <div class="pl-4">
        <table class="table table-sm table-borderless my-0 py-0">
          <tbody>
            <tr style="line-height:13px;height:13px;">
              <td>Subtotal:</td>
              <td class="text-right"><%= '%.2f' % @invoice.subtotal %></td>
            </tr>
            <tr style="line-height:13px;height:13px;">
              <td>Descuento:</td>
              <td class="text-right"><%= '%.2f' % @invoice.discount %></td>
            </tr>
            <%# Gift card? QR? another payments? %>
            <tr style="line-height:13px;height:13px;">
              <td>Total a pagar Bs.:</td>
              <td class="text-right"><%= '%.2f' % @invoice.total %></td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="w-100" style="border-top: 1px solid #000;">
        <div class="m-0 py-0">SON: <%= @literal_amount.upcase %> Bs.</div>
      </div>
      <div class="ml-0 pl-0">
        <table class="table table-sm table-borderless my-0 py-0">
          <tbody>
            <tr style="line-height:13px;height:13px;">
              <td>Importe crédito fiscal Bs.:</td>
              <td class="text-right"><%= '%.2f' % @invoice.total %></td>
            </tr>
          </tbody>
        </table>
        </div>
      <div class="w-100 m-0 py-3">Usr.: <%= @invoice.user %></div>
      <div>
        "ESTA FACTURA CONTRIBUYE AL DESARROLLO DEL PAÍS, EL USO ILÍCITO SERÁ SANCIONADO PENALMENTE DE ACUERDO A LEY"
      </div>
      <div class="pt-2 px-2">
        Este documento es la Representación Gráfica de un Documento Fiscal Digital emitido en una modalidad de facturación en línea
      </div>
      <div class="pt-2"><%= @invoice.legend %></div>
      <div class="pt-2 text-center"><strong>NO SE ACEPTAN CAMBIOS NI DEVOLUCIONES</strong></div>
    </div>
    <div class="text-center pt-2">
      <%= wicked_pdf_image_tag asset_url(@qr_code_file) %>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>
  </body>
</html>